<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>Relat칩rios - Sala Arco-칤ris</title>
  <link rel="stylesheet" type="text/css" href="subtelas_css/registro_relatorio.css"/>
</head>
<body>

  <!-- Cabe칞alho da p치gina -->
  <header> 
    <h1> RELAT칍RIOS </h1>
  </header>

  <!-- T칤tulo de se칞칚o -->
  <h2>Informa칞칫es necess치rias:</h2>

  <div class="container">
    <!-- Formul치rio para preenchimento dos dados -->
    <form class="formulario" id="form_login" action="#" method="post">
      
      <!-- Linha de entrada para ID do Funcion치rio e Nome -->
      <div class="linha-dupla">
        <!-- Campo para ID do Funcion치rio -->
        <div class="input-group">
          <p>ID do funcion치rio:</p>
          <span class="icon">#</span>
          <input type="number" name="id" id="id_funcionario" required oninput="preencherNomeFuncionario()">
        </div>

        <!-- Campo para Nome do Funcion치rio (apenas leitura) -->
        <div class="input-group">
          <p>Nome do funcion치rio:</p>
          <span class="icon">游녻</span>
          <input type="text" name="nome_funcionario" id="nome_funcionario" readonly>
        </div>
      </div>

      <!-- Linha de entrada para Nome do Relat칩rio e Data -->
      <div class="linha-dupla">
        <!-- Campo para Nome do Relat칩rio -->
        <div class="input-group">
          <p>Nome do relat칩rio:</p>
          <span class="icon">游</span>
          <input type="text" name="nome_relatorio" required>
        </div>

        <!-- Campo para Data (preenchido com a data de hoje) -->
        <div class="input-group">
          <p>Data:</p>
          <span class="icon">游늰</span>
          <input type="date" name="data" id="data" required min="" max="">
        </div>
      </div>

      <!-- Linha de entrada para o Arquivo -->
      <div class="input-group arquivo">
        <p>
          Arquivo: (PDF, WORD E EXCEL)
          <span class="icon">游늭</span>
        </p>
        <!-- Exibi칞칚o do nome do arquivo selecionado -->
        <input type="text" name="arquivo" id="arquivo" readonly placeholder="Nenhum arquivo selecionado">
        <!-- Campo de sele칞칚o de arquivo -->
        <input type="file" id="seletor_arquivo" accept=".pdf, .doc, .docx, .xls, .xlsx" style="display: none;" multiple onchange="atualizarNomeArquivo()">
      </div>
      
      <!-- Bot칚o para abrir o seletor de arquivos -->
      <button type="button" class="botao-inline" onclick="document.getElementById('seletor_arquivo').click()">Selecionar Arquivo</button>

      <!-- Linha de bot칫es de Enviar e Cancelar -->
      <div class="linha-dupla">
        <!-- Bot칚o de Enviar -->
        <div class="botao-wrapper">
          <button class="botao-enviar" id="botao-enviar">Enviar</button>
        </div>

      <!-- Bot칚o de Cancelar -->
      <div class="botao-wrapper">
        <button class="botao-cancelar" id="botao-cancelar">Cancelar</button>
      </div>
      </div>
    </form>
  </div>

  <!-- Importa칞칚o da biblioteca de Alertas (SweetAlert) -->
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <script>
    // Fun칞칚o para atualizar o nome do arquivo selecionado
    function atualizarNomeArquivo() {
      const inputArquivo = document.getElementById('seletor_arquivo');
      const nomeArquivo = document.getElementById('arquivo');
      const listaArquivos = document.getElementById('lista-arquivos');
      const arquivoBox = document.getElementById('arquivo-box');
      const arquivosSelecionados = inputArquivo.files;

      // Verifica se h치 arquivos selecionados
      if (arquivosSelecionados.length > 0) {
        // Exibe o nome do primeiro arquivo selecionado
        nomeArquivo.value = arquivosSelecionados[0].name;
        arquivoBox.style.display = 'block';
        listaArquivos.innerHTML = '';
        
        // Lista os arquivos selecionados
        for (let i = 0; i < arquivosSelecionados.length; i++) {
          const li = document.createElement('li');
          li.textContent = arquivosSelecionados[i].name;
          listaArquivos.appendChild(li);
        }
      } else {
        // Caso nenhum arquivo seja selecionado
        nomeArquivo.value = 'Nenhum arquivo selecionado';
        arquivoBox.style.display = 'none';
      }
    }


    document.getElementById('botao-enviar').addEventListener('click', function (e) {
  e.preventDefault(); // Impede o envio padr칚o do formul치rio

  const form = document.getElementById('form_login');
  const inputs = form.querySelectorAll('input[required]');
  const arquivoInput = document.getElementById('seletor_arquivo');

  let todosPreenchidos = true;

  inputs.forEach(input => {
    if (!input.value.trim()) {
      todosPreenchidos = false;
    }
  });

  if (todosPreenchidos && arquivoInput.files.length > 0) {
    Swal.fire({
      title: 'Sucesso!',
      text: 'Relat칩rio enviado com sucesso!',
      icon: 'success',
      confirmButtonText: 'OK',
      confirmButtonColor: '#ffbcfc'
    }).then((result) => {
      if (result.isConfirmed) {
        form.submit(); // Submete o formul치rio ap칩s confirma칞칚o
      }
    });
  } else {
    Swal.fire({
      title: 'Erro!',
      text: 'Preencha todos os campos e selecione um arquivo.',
      icon: 'error',
      confirmButtonText: 'OK',
      confirmButtonColor: '#ffbcfc'
    });
  }
});

      // Fun칞칚o chamada ao clicar no bot칚o "Cancelar" - exibe um alerta de erro
      document.getElementById('botao-cancelar').addEventListener('click', function () {
  Swal.fire({
    title: 'Cancelado!',
    text: 'Envio do relat칩rio cancelado!',
    icon: 'warning',
    confirmButtonText: 'OK',
    confirmButtonColor: '#ffbcfc'
  }).then(() => {
    const form = document.getElementById('form_login');
    form.reset(); // Limpa todos os campos do formul치rio

    // Zera o campo de nome do funcion치rio (readonly)
    document.getElementById('nome_funcionario').value = '';

    // Zera o campo de exibi칞칚o do nome do arquivo
    document.getElementById('arquivo').value = 'Nenhum arquivo selecionado';

    // Limpa arquivos selecionados
    document.getElementById('seletor_arquivo').value = '';
  });
});


  </script>
</body>
  <script src="subtelas_javascript/registro_relatorios.js"></script>
</html>
